<div class="card">
    <div style="display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #333; padding-bottom: 12px; margin-bottom: 15px;">
        <h2 style="border: none; margin: 0; padding: 0; margin-bottom: 0;">‚è∞ Scheduler</h2>
        <a href="/admin/scheduler" style="padding: 4px 12px; background: #1e1e1e; color: #64b5f6; border: 1px solid #64b5f6; border-radius: 4px; cursor: pointer; font-size: 0.75rem; font-weight: bold; text-decoration: none; transition: all 0.2s;">
            Manage
        </a>
    </div>
    
    <div id="scheduler-summary" style="display: flex; flex-direction: column; gap: 12px;">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <span style="color: #888;">Service Status</span>
            <span id="sched-status-badge" class="badge">Checking...</span>
        </div>
        
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <span style="color: #888;">Running Jobs</span>
            <span id="sched-running-count" style="font-weight: bold;">--</span>
        </div>

        <div style="display: flex; justify-content: space-between; align-items: center;">
            <span style="color: #888;">Next Job</span>
            <small id="sched-next-job" style="color: #aaa; text-align: right;">--</small>
        </div>
    </div>
</div>

<script>
    async function loadSchedulerStatus() {
        try {
            // Heartbeat
            const res = await fetch('/api/scheduler/status');
            const data = await res.json();
            
            const badge = document.getElementById('sched-status-badge');
            if (data.status === 'RUNNING') {
                badge.innerText = 'ACTIVE';
                badge.className = 'badge active';
                
                // Parse Info
                if(data.info) {
                     document.getElementById('sched-running-count').innerText = data.info.jobs_running || 0;
                }
            } else {
                badge.innerText = 'DOWN';
                badge.className = 'badge expired';
                document.getElementById('sched-running-count').innerText = '0';
            }
            
            // Getting 'Next Job' is tricky from generic API, maybe fetch job list and calc?
            // For now, let's just show Active status.
            
        } catch (e) {
            console.error(e);
            document.getElementById('sched-status-badge').innerText = 'ERR';
        }
    }
    loadSchedulerStatus();
    setInterval(loadSchedulerStatus, 30000);
</script>
